      CBL CICS('COBOL3,SP') APOST
PROCESS MAP,XREF,TRUNC(BIN)
      *****************************************************************
      *                                                               *
      * MODULE NAME = DFH0STLK                                        *
      *                                                               *
      * DESCRIPTIVE NAME = Collect and Print Statistics Sample        *
      *                                                               *
      *                                                               *
      *                                                               *
      *     Licensed Materials - Property of IBM                      *
      *                                                               *
      *     "Restricted Materials of IBM"                             *
      *                                                               *
      *     5655-Y04                                                  *
      *                                                               *
      *     (C) Copyright IBM Corp. 2000, 2016"                       *
      *                                                               *
      *                                                               *
      *                                                               *
      *                                                               *
      * STATUS = 7.2.0                                                *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      * DESCRIPTION :                                                 *
      *                                                               *
      *     This set of programs illustrate ways of using the EXEC    *
      *     CICS INQUIRE, COLLECT and EXTRACT STATISTICS commands of  *
      *     CICS to produce information about a CICS system.          *
      *     The reports include a CICS and MVS storage analysis.      *
      *     Statistics obtained using these commands can be used to   *
      *     aid the specification of the DSA Size parameters.         *
      *     (See the CICS Performance Guide and CICS Data Areas       *
      *      manuals for more information, and the CICS System        *
      *      Programming Reference for use of commands)               *
      *                                                               *
      *     These programs can be invoked from the PLT at PLTSD or    *
      *     as a CICS transaction (conversationally).                 *
      *     The output is sent via the CICS JES SPOOL interface for   *
      *     which a number of default parameters can be changed by    *
      *     the user to specify the distribution of the report(s).    *
      *     These defaults are defined in the working-storage         *
      *     section of the DFH0STAT program under the 01 level        *
      *     "OUTPUT-DEFAULTS".                                        *
      *                                                               *
      *     Installation instructions:-                               *
      *     Require SIT parameters:-  SPOOL=YES                       *
      *     Required CICS definitions:-                               *
      *         Transactions:-  STAT -> DFH0STAT                      *
      *         Programs:-    DFH0STAT   IBM COBOL                    *
      *                       DFH0STDB       for OS/390 & VM          *
      *                       DFH0STEJ           2.1.1 or later       *
      *                       DFH0STEP       "   "   "                *
      *                       DFH0STGN       "   "   "                *
      *                       DFH0STLK       "   "   "                *
      *                       DFH0STPR       "   "   "                *
      *                       DFH0STSA       "   "   "                *
      *                       DFH0STSY       "   "   "                *
      *                       DFH0STTP       "   "   "                *
      *                       DFH0STTS       "   "   "                *
      *                       DFH0STWB       "   "   "                *
      *                       DFH$STAS   Assembler                    *
      *                       DFH$STCN   Assembler                    *
      *                       DFH$STTB   Assembler                    *
      *         Mapsets:-     DFH0STM                                 *
      *                       DFH0STS                                 *
      *                                                               *
      *     The CICS-supplied RDO group, DFH$STAT, contains all       *
      *     the necessary resource definitions for this sample.       *
      *                                                               *
      *     All programs are command level and run above the          *
      *     16Mb line. Note: that DFH0STAT, DFH0STDB, DFH0STEJ,       *
      *     DFH0STEP, DFH0STGN, DFH0STLK, DFH0STPR, DFH0STSA,         *
      *     DFH0STSY, DFH0STTP, DFH0STTS, and DFH0STWB must be        *
      *     translated with the Translator options "COBOL3 and SP".   *
      *                                                               *
      *   SPOOL errors.  If an EXEC CICS SPOOL .. command fails       *
      *   when the program is run as a transaction, an error message  *
      *   is displayed on the users screen and the transaction will   *
      *   continue.  If the program is not being run from a terminal  *
      *   then a message will be sent to the console using EXEC       *
      *   CICS WRITE OPERATOR commands and the transaction will be    *
      *   terminated normally.                                        *
      *                                                               *
      *---------------------------------------------------------------*
      *                                                               *
      * CHANGE ACTIVITY :                                             *
      * $SEG(DFH0STLK), COMP(SAMPLES) PROD(CICS)                      *
      *                                                               *
      *  PN= REASON REL YYMMDD HDXIII : REMARKS                       *
      * $01= A63143 630 020905 HD1VCJB: Migrate PQ63143 from SPA R620 *
      * $02= A76702 630 030813 HD4PALS: Migrate PQ76702 from SPA R620 *
      * $D1= I07099 620 001120 HD1VCJB : Statistics Enhancements      *
      * $D3= I07552 640 050426 HD0JADT: MQCONN statistics             *
      * $D4= I07551 650 050920 HD4PALS: MQ Conn should be Websphere MQ*
      * $D5= I07799 650 070111 HD1VCJB: change use of ip connection   *
      * $L0= 795    610 000124 HD1VCJB : Module create                *
      * $L1= 773    620 000627 HD1VCJB : Statistics Support for ECI   *
      * $L2= 819    620 010627 HD1VCJB : Statistics Changes           *
      * $L3= 832    630 020219 HD1VCJB : Support for JVMProfiles      *
      * $L4= 832    630 020424 HD1VCJB : Statistics Sample Program Up *
      * $L5= 832    630 020905 HD1VCJB : Initial Support for JVM Pro  *
      * $L6= 781    640 040224 HD1VCJB: Initial DFH0STAT Updates for 3*
      * $L7= 710    650 060112 HD1VCJB: 3 - IPCONN statistics         *
      * $L8= 891    650 060519 HD1VCJB: 64 Bit Storage Statistics     *
      * $L9= 897    650 061010 HD1VCJB: LIBRARY Stats Infrastructure  *
      * $LA= 907    660 071005 HD1VCJB: Part 3 RDO audit for PROGRAM  *
      * $LB= 923    660 080513 HD1VCJB: Atomservice Statistics Support*
      * $LC= 927    660 080604 HD1VCJB: Event Processing Support      *
      * $LD= 937    660 080724 HD1VCJB: JVMSERVER Statistics Support  *
      * $LE= 936    660 081105 HD1VCJB: XMLTRANSFORM Statistics Suppor*
      * $LF= 927    660 081123 HD1VCJB: CAPTURESPEC Statistics Support*
      * $LG= R00256 670 100723 HD4IAEC: EPADAPTER statistics          *
      *      R38170 680 111205 HD1VCJB: Remove EJB Statistics         *
      *      R38180 680 111220 HD1VCJB: Remove JVM Statistics         *
      *     R131367 710 161025 HDLHJJH: Add AS statistics             *
      *     R148775 720 180718 HDLHJJH: New NODEJSAPP statistics      *
      * $P1= M15441 610 000505 HD1VCJB : Statistics Consistency for T *
      * $P2= D02075 620 010508 HD3SCWG : Correct spelling of COMMAREA *
      * $P3= D03414 620 011105 HD1VCJB : Correct LSRPool Comments     *
      * $P4= D08547 630 030725 HD4PALS: Change JVMPool to JVM pool    *
      * $P5= D19041 650 070508 HD1VCJB: Correct Intermittent 0C7      *
      * $P6= D25351 660 090313 HD1VCJB: Missing Pageno Initialise     *
      *      D98593 700 150106 HD3BADW: Fix comments                  *
      *     D150786 720 181023 HDFVGMB: Add TRUNC(BIN) to PROCESS     *
      *                                                               *
      *****************************************************************
       ID DIVISION.
       PROGRAM-ID. DFH0STLK.

       ENVIRONMENT DIVISION.
           EJECT
       DATA DIVISION.
       WORKING-STORAGE SECTION.
       77  STCM-COMMAREA               PIC S9(4)  COMP.

      ****************************************************************
      ***  Report heading line definition                           ***
      *****************************************************************
       01  PRINT-LINE.
           03  PRINT-CONTROL           PIC X.
           03  PP1-132.
               05  FILLER              PIC XX.
               05  PP3-84.
                   07  PP3-14          PIC X(12).
                   07  FILLER          PIC X(70).
               05  FILLER              PIC X(48).
           03  FILLER REDEFINES PP1-132.
               05  FILLER              PIC X(4).
               05  PP5-41              PIC X(37).
               05  FILLER              PIC X.
               05  PP43-52             PIC ZZ,ZZZ,ZZ9.
               05  FILLER              PIC X(80).
           03  FILLER REDEFINES PP1-132.
               05  PP1-10              PIC X(10).
               05  FILLER              PIC X(38).
               05  PP49-52.
                   07  FILLER          PIC X.
                   07  PP50-52         PIC XXX.
               05  FILLER              PIC X(54).
               05  PP107-110           PIC X(4).
               05  FILLER              PIC X(22).
           03  FILLER REDEFINES PP1-132.
               05  FILLER              PIC XX.
               05  PP3-25.
                   07  PP3-23.
                       09  PP3-21.
                           11  PP3-13  PIC X(11).
                           11  FILLER  PIC X(8).
                       09  FILLER      PIC XX.
                   07  FILLER          PIC XX.
               05  FILLER REDEFINES PP3-25.
                   07  PP3-19.
                       09  PP3-18.
                           11  PP3-7   PIC X(5).
                           11  FILLER  PIC X(11).
                       09  FILLER      PIC X.
                   07  FILLER          PIC X(6).
               05  FILLER REDEFINES PP3-25.
                   07  PP3-17.
                       09  PP3-16.
                           11  PP3-15  PIC X(13).
                           11  FILLER  PIC X.
                       09  FILLER      PIC X.
                   07  FILLER          PIC X(8).
               05  FILLER REDEFINES PP3-25.
                   07  PP3-12.
                       09  PP3-11.
                           11  PP3-10  PIC X(8).
                           11  FILLER  PIC X.
                       09  FILLER      PIC X.
                   07  FILLER          PIC X(13).
               05  FILLER REDEFINES PP3-25.
                   07  PP3-9.
                       09  PP3-8.
                           11  PP3-5   PIC XXX.
                           11  FILLER  PIC XXX.
                       09  FILLER      PIC X.
                   07  FILLER          PIC X(16).
               05  FILLER              PIC X(107).
           EJECT
       LINKAGE SECTION.
           EJECT
      *****************************************************************
      ***  Statistics Sample Programs Commarea.                     ***
      *****************************************************************
       01  DFHCOMMAREA.
           COPY DFH0STCM.
           EJECT
      *****************************************************************
      ***                                                           ***
      ***           CICS Collect and print statistics               ***
      ***                                                           ***
      *****************************************************************
       PROCEDURE DIVISION.

      *****************************************************************
      *** MAIN-PROCESSING                                           ***
      ***     Set default destination fields for output             ***
      ***     Get initial CICS information                          ***
      ***     SELECT on CICS status                                 ***
      ***        WHEN startup                                       ***
      ***            process statistics print                       ***
      ***        WHEN active                                        ***
      ***            IF primary facility is a terminal THEN         ***
      ***                IF terminal is a 3270 THEN                 ***
      ***                    process terminal input                 ***
      ***                ELSE                                       ***
      ***                    process statistics print               ***
      ***            ELSE                                           ***
      ***                process statistics print                   ***
      ***        WHEN first stage quiesce                           ***
      ***            process statistics print                       ***
      ***        WHEN final quiesce no action                       ***
      ***        WHEN other no action                               ***
      ***     END SELECT                                            ***
      ***     RETURN                                                ***
      *****************************************************************

       MAIN-PROCESSING SECTION.

           PERFORM PRINT-STATISTICS.

           EXEC CICS RETURN
           END-EXEC.

       MAIN-PROCESSING-EXIT.
           GOBACK.
           EJECT
      *****************************************************************
      *****************************************************************
      ***         Collect and Print the CICS/ESA Statistics         ***
      *****************************************************************
      *****************************************************************
      ***                                                           ***
      *** 1.  Initialise the page numbers.                          ***
      *** 2.  Link to 'DFH0STSY' to print the statistics for:-      ***
      ***     - System Status                                       ***
      ***     - Transaction Manager                                 ***
      ***     - Dispatcher                                          ***
      ***     - Dispatcher MVS TCBs                                 ***
      *** 3.  Link to 'DFH0STSA' to print the statistics for:-      ***
      ***     - Storage Analysis (DSA's)                            ***
      ***     - Loader (Global)                                     ***
      ***     - Library (Resource)                                  ***
      ***     - Library Dataset Concatenation                       ***
      *** 4.  Link to 'DFH0STTP' to print the statistics for:-      ***
      ***     - Transaction Classes                                 ***
      ***     - Transactions                                        ***
      ***     - Programs                                            ***
      ***     - Programs by DSA and LPA                             ***
      ***     - DFHRPL and LIBRARY Analysis                         ***
      *** 5.  Link to 'DFH0STTS' to print the statistics for:-      ***
      ***     - Temporary Storage (Global)                          ***
      ***     - Temporary Storage Models                            ***
      ***     - Temporary Storage Queues                            ***
      ***     - Transient Data (Global and Resource)                ***
      *** 6.  Link to 'DFH0STPR' to print the statistics for:-      ***
      ***     - Journalnames                                        ***
      ***     - Logstream Global - DFHLOG and DFHSHUNT              ***
      ***     - Logstreams                                          ***
      ***     - Program Autoinstall                                 ***
      ***     - Terminal Autoinstall and VTAM                       ***
      ***     - Connections and Modenames                           ***
      ***     - TCP/IP                                              ***
      ***     - TCPIPSERVICE Resources                              ***
      ***     - IPCONN Resources                                    ***
      *** 7.  Link to 'DFH0STEP' to print the statistics for:-      ***
      ***     - Event Processing                                    ***
      ***     - EPADAPTER Resources                                 ***
      ***     - EVENTBINDING Resources                              ***
      ***     - CAPTURESPEC Resources                               ***
      ***     - ASYNCSERVICE                                        ***
      *** 8.  Link to 'DFH0STWB' to print the statistics for:-      ***
      ***     - BUNDLE Resources                                    ***
      ***     - URIMAP Resources                                    ***
      ***     - Virtual Hosts                                       ***
      ***     - ATOMSERVICE Resources                               ***
      ***     - PIPELINE Resources                                  ***
      ***     - WEBSERVICE Resources                                ***
      ***     - DOCTEMPLATE Resources                               ***
      ***     - XMLTRANSFORM Resources                              ***
      *** 9.  Link to 'DFH0STEJ' to print the statistics for:-      ***
      ***     - JVM Programs                                        ***
      ***     - JVMSERVERs                                          ***
      ***     - NODEJSAPPs                                          ***
      *** 10. Link to 'DFH0STDB' to print the statistics for:-      ***
      ***     - LSRPools                                            ***
      ***     - Files                                               ***
      ***     - Data Set Names                                      ***
      ***     - Data Tables                                         ***
      ***     - DB2 Connection                                      ***
      ***     - DB2 Entries                                         ***
      *** 11. Link to 'DFH0STGN' to print the statistics for:-      ***
      ***     - User Exit Programs                                  ***
      ***     - Global User Exits                                   ***
      ***     - Trace Settings and Levels                           ***
      ***     - Enqueue Manager                                     ***
      ***     - Enqueue Models                                      ***
      ***     - Recovery Manager                                    ***
      *** 12. Print the Page Index if selected                      ***
      ***                                                           ***
      *****************************************************************
      *****************************************************************

       PRINT-STATISTICS SECTION.

           PERFORM PAGENOS-INITIALISE.

      *****************************************************************
      *** Setup commarea length.                                    ***
      *****************************************************************
           MOVE LENGTH OF DFHCOMMAREA TO STCM-COMMAREA.

      *****************************************************************
      ***  Link to 'DFH0STSY' to print the statistics for:-         ***
      ***    - System Status                                        ***
      ***    - Transaction Manager                                  ***
      ***    - Dispatcher                                           ***
      ***    - Dispatcher MVS TCBs                                  ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STSY')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STSY. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STSA' to print the statistics for:-         ***
      ***    - Storage Analysis (DSA's)                             ***
      ***    - Loader (Global)                                      ***
      ***    - Library (Resource)                                   ***
      ***    - Library Dataset Concatenation                        ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STSA')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STSA. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STTP' to print the statistics for:-         ***
      ***    - Transaction Classes                                  ***
      ***    - Transactions                                         ***
      ***    - Programs                                             ***
      ***    - Programs by DSA and LPA                              ***
      ***    - DFHRPL and LIBRARY Analysis                          ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STTP')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STTP. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STTS' to print the statistics for:-         ***
      ***    - Temporary Storage (Global)                           ***
      ***    - Temporary Storage Models                             ***
      ***    - Temporary Storage Queues                             ***
      ***    - Transient Data (Global and Resource)                 ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STTS')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STTS. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STPR' to print the statistics for:-         ***
      ***    - Journalnames                                         ***
      ***    - Logstream Global - DFHLOG and DFHSHUNT               ***
      ***    - Logstreams                                           ***
      ***    - Program Autoinstall                                  ***
      ***    - Terminal Autoinstall and VTAM                        ***
      ***    - Connections and Modenames                            ***
      ***    - TCP/IP                                               ***
      ***    - TCPIPSERVICE Resources                               ***
      ***    - IPCONN REsources                                     ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STPR')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STPR. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STEP' to print the statistics for:-         ***
      ***    - Event Processing                                     ***
      ***    - EPADAPTER Resources                                  ***
      ***    - EVENTBINDING Resources                               ***
      ***    - CAPTURESPEC Resources                                ***
      ***    - ASYNCSERVICE                                         ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STEP')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STEP. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STWB' to print the statistics for:-         ***
      ***    - BUNDLE Resources                                     ***
      ***    - URIMAP Resources                                     ***
      ***    - Virtual Hosts                                        ***
      ***    - ATOMSERVICE Resources                                ***
      ***    - PIPELINE Resources                                   ***
      ***    - WEBSERVICE Resources                                 ***
      ***    - DOCTEMPLATE Resources                                ***
      ***    - XMLTRANSFORM Resources                               ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STWB')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STWB. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STEJ' to print the statistics for:-         ***
      ***    - JVM Programs                                         ***
      ***    - JVMSERVERs                                           ***
      ***    - NODEJSAPPs                                           ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STEJ')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STEJ. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STDB' to print the statistics for:-         ***
      ***    - Files                                                ***
      ***    - Data Set Names                                       ***
      ***    - Data Tables                                          ***
      ***    - DB2 Connection                                       ***
      ***    - DB2 Entries                                          ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STDB')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STDB. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      ***  Link to 'DFH0STGN' to print the statistics for:-         ***
      ***    - User Exit Programs                                   ***
      ***    - Global User Exits                                    ***
      ***    - Trace Settings and Levels                            ***
      ***    - Enqueue Manager                                      ***
      ***    - Enqueue Models                                       ***
      ***    - Recovery Manager                                     ***
      *****************************************************************

           EXEC CICS LINK PROGRAM('DFH0STGN')
               COMMAREA(DFHCOMMAREA) LENGTH(STCM-COMMAREA)
           END-EXEC.

      *****************************************************************
      *** If other than a RESP of NORMAL is returned something very ***
      *** nasty occurred in DFH0STGN. We need to return to DFH0STAT ***
      *** via DFH0STLK and perform the common error routine to      ***
      *** issue the appropriate message to the user.                ***
      *****************************************************************
           IF STCM-RESP NOT = DFHRESP(NORMAL) THEN
               GO TO PRINT-STATISTICS-EXIT
           END-IF.

      *****************************************************************
      *** Print the Page Index if requested                         ***
      *****************************************************************
           IF SELECT-PAGE-INDEX = 'Y' OR 'y' THEN
               PERFORM PRINT-PAGE-INDEX
           END-IF.

       PRINT-STATISTICS-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      *** PRINT-PAGE-INDEX                                          ***
      *****************************************************************
       PRINT-PAGE-INDEX SECTION.

      *****************************************************************
      ***  Print the Page Index headings - Page 1                   ***
      *****************************************************************
           PERFORM PAGE-HEADINGS.

           MOVE '-'     TO PRINT-CONTROL.
           MOVE 'Page Index' TO PP1-10.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP1-10.
           PERFORM WRITE-OUTPUT.

      *****************************************************************
      ***  Print the Page Index - Page 1                            ***
      *****************************************************************
           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'Asynchronous Services'  TO PP3-25.
           MOVE 'Page'  TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-5 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'ASYNCSERVICE. . . . . . . . . . . . :' TO PP5-41.
           IF ASYNCSERVICE-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE ASYNCSERVICE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'DB2'   TO PP3-5.
           MOVE 'Page'  TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-5 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'DB2 Connection. . . . . . . . . . . :' TO PP5-41.
           IF DB2-CONNECTION-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE DB2-CONNECTION-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'DB2 Entries . . . . . . . . . . . . :' TO PP5-41.
           IF DB2-ENTRIES-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE DB2-ENTRIES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'Dispatcher' TO PP3-12.
           MOVE 'Page'       TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-12
                           PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0'     TO PRINT-CONTROL.
           MOVE 'Dispatcher. . . . . . . . . . . . . :' TO PP5-41.
           IF DISPATCHER-PAGENO = 0 THEN
               MOVE 'N/S'             TO PP50-52
           ELSE
               MOVE DISPATCHER-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Dispatcher MVS TCBs . . . . . . . . :' TO PP5-41.
           IF DISPATCHER-MVS-TCB-PAGENO = 0 THEN
               MOVE 'N/S'                     TO PP50-52
           ELSE
               MOVE DISPATCHER-MVS-TCB-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Dispatcher TCB Modes. . . . . . . . :' TO PP5-41.
           IF DISPATCHER-TCB-MODES-PAGENO = 0 THEN
               MOVE 'N/S'                       TO PP50-52
           ELSE
               MOVE DISPATCHER-TCB-MODES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Dispatcher TCB Pools. . . . . . . . :' TO PP5-41.
           IF DISPATCHER-TCB-POOLS-PAGENO = 0 THEN
               MOVE 'N/S'                       TO PP50-52
           ELSE
               MOVE DISPATCHER-TCB-POOLS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Enqueue Manager' TO PP3-17.
           MOVE 'Page'            TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-17 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Enqueue Manager . . . . . . . . . . :' TO PP5-41.
           IF ENQUEUE-MGR-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE ENQUEUE-MGR-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Enqueue Models. . . . . . . . . . . :' TO PP5-41.
           IF ENQMODELS-PAGENO = 0 THEN
               MOVE 'N/S'            TO PP50-52
           ELSE
               MOVE ENQMODELS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Event Processing' TO PP3-18.
           MOVE 'Page'             TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-18 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'CAPTURESPECs. . . . . . . . . . . . :' TO PP5-41.
           IF CAPTURESPECS-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE CAPTURESPECS-PAGENO  TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'EPADAPTERs. . . . . . . . . . . . . :' TO PP5-41.
           IF EPADAPTERS-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE EPADAPTERS-PAGENO    TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Event Processing. . . . . . . . . . :' TO PP5-41.
           IF EVENT-PROCESS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE EVENT-PROCESS-PAGENO  TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'EVENTBINDINGs . . . . . . . . . . . :' TO PP5-41.
           IF EVENTBINDINGS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE EVENTBINDINGS-PAGENO  TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Files and Data Tables' TO PP3-23.
           MOVE 'Page'                  TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-23 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Coupling Facility Data Table Pools. :' TO PP5-41.
           IF CFDT-POOLS-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE CFDT-POOLS-PAGENO  TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Data Tables . . . . . . . . . . . . :' TO PP5-41.
           IF DATA-TABLES-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE DATA-TABLES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Data Set Names. . . . . . . . . . . :' TO PP5-41.
           IF DSNAMES-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE DSNAMES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Files . . . . . . . . . . . . . . . :' TO PP5-41.
           IF FILES-PAGENO = 0 THEN
               MOVE 'N/S'        TO PP50-52
           ELSE
               MOVE FILES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'LSR Pools . . . . . . . . . . . . . :' TO PP5-41.
           IF LSRPOOLS-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE LSRPOOLS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Global User Exits' TO PP3-19.
           MOVE 'Page'  TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-19 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Global User Exits . . . . . . . . . :' TO PP5-41.
           IF USER-EXITS-PAGENO = 0 THEN
               MOVE 'N/S'             TO PP50-52
           ELSE
               MOVE USER-EXITS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'User Exit Programs. . . . . . . . . :' TO PP5-41.
           IF EXIT-PGM-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE EXIT-PGM-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Journals and Logstreams' TO PP3-25.
           MOVE 'Page'  TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-25
                           PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Journalnames. . . . . . . . . . . . :' TO PP5-41.
           IF JOURNALS-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE JOURNALS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Logstream - Global. . . . . . . . . :' TO PP5-41.
           IF LOGSTREAM-GLOBAL-PAGENO = 0 THEN
               MOVE 'N/S'                   TO PP50-52
           ELSE
               MOVE LOGSTREAM-GLOBAL-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Logstreams. . . . . . . . . . . . . :' TO PP5-41.
           IF LOGSTREAMS-PAGENO = 0 THEN
               MOVE 'N/S'             TO PP50-52
           ELSE
               MOVE LOGSTREAMS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '-' TO PRINT-CONTROL.
           MOVE '''N/S'' indicates that the statistics report was not se
      -        'lected for printing          ' TO PP3-84.
           PERFORM WRITE-OUTPUT.

      *****************************************************************
      ***  Print the Page Index headings - Page 2                   ***
      *****************************************************************
           PERFORM PAGE-HEADINGS.

           MOVE '-'     TO PRINT-CONTROL.
           MOVE 'Page Index' TO PP1-10.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP1-10.
           PERFORM WRITE-OUTPUT.

      *****************************************************************
      ***  Print the Page Index - Page 2                            ***
      *****************************************************************

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'JVM'  TO PP3-5.
           MOVE 'Page' TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-5 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'JVM Programs. . . . . . . . . . . . :' TO PP5-41.
           IF JVM-PROGRAMS-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE JVM-PROGRAMS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'JVMSERVERs. . . . . . . . . . . . . :' TO PP5-41.
           IF JVMSERVERS-PAGENO = 0 THEN
               MOVE 'N/S'             TO PP50-52
           ELSE
               MOVE JVMSERVERS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'MRO/ISC' TO PP3-9.
           MOVE 'Page'    TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-9 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Connections and Modenames . . . . . :' TO PP5-41.
           IF CONNECTIONS-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE CONNECTIONS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'IPCONNs . . . . . . . . . . . . . . :' TO PP5-41.
           IF IPCONNS-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE IPCONNS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Node.js' TO PP3-9.
           MOVE 'Page'     TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-9 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.

           MOVE 'NODEJSAPPs. . . . . . . . . . . . . :' TO PP5-41.
           IF NODEJSAPP-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE NODEJSAPP-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Programs and LIBRARYs' TO PP3-23.
           MOVE 'Page'     TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-23 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.

           MOVE 'DFHRPL and LIBRARY Analysis . . . . :' TO PP5-41.
           IF DFHRPL-ANALYSIS-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE DFHRPL-ANALYSIS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Loader. . . . . . . . . . . . . . . :' TO PP5-41.
           IF LOADER-PAGENO = 0 THEN
               MOVE 'N/S'         TO PP50-52
           ELSE
               MOVE LOADER-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'LIBRARYs. . . . . . . . . . . . . . :' TO PP5-41.
           IF LIBRARY-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE LIBRARY-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'LIBRARY Dataset Concatenation . . . :' TO PP5-41.
           IF LIBRARY-DSNAME-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE LIBRARY-DSNAME-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Program Autoinstall . . . . . . . . :' TO PP5-41.
           IF PGM-AUTOINSTALL-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE PGM-AUTOINSTALL-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Program Definitions . . . . . . . . :' TO PP5-41.
           IF PROGRAMDEFS-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE PROGRAMDEFS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Program Storage . . . . . . . . . . :' TO PP5-41.
           IF PROGRAM-STORAGE-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE PROGRAM-STORAGE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Program Totals. . . . . . . . . . . :' TO PP5-41.
           IF PROGRAM-TOTALS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE PROGRAM-TOTALS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Programs. . . . . . . . . . . . . . :' TO PP5-41.
           IF PROGRAMS-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE PROGRAMS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Programs by DSA and LPA . . . . . . :' TO PP5-41.
           IF PROGRAMS-BY-DSA-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE PROGRAMS-BY-DSA-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Recovery Manager' TO PP3-18.
           MOVE 'Page'             TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-18 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Recovery Manager. . . . . . . . . . :' TO PP5-41.
           IF RECOVERY-MGR-PAGENO = 0 THEN
               MOVE 'N/S'               TO PP50-52
           ELSE
               MOVE RECOVERY-MGR-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Storage Manager' TO PP3-17.
           MOVE 'Page'            TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE ALL '_' TO PP3-17 PP49-52.
           MOVE '+'     TO PRINT-CONTROL.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Storage Manager BELOW 16MB. . . . . :' TO PP5-41.
           IF STORAGE-BELOW-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE STORAGE-BELOW-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Storage Manager ABOVE 16MB. . . . . :' TO PP5-41.
           IF STORAGE-ABOVE-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE STORAGE-ABOVE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Storage Manager ABOVE 2GB . . . . . :' TO PP5-41.
           IF STORAGE-ABOVE-BAR-PAGENO = 0 THEN
               MOVE 'N/S'                    TO PP50-52
           ELSE
               MOVE STORAGE-ABOVE-BAR-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Storage Subpools - Domain . . . . . :' TO PP5-41.
           IF STG-DOMAIN-SUBPOOLS-PAGENO = 0 THEN
               MOVE 'N/S'                      TO PP50-52
           ELSE
               MOVE STG-DOMAIN-SUBPOOLS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Storage Subpools - Program. . . . . :' TO PP5-41.
           IF STG-PROGRAM-SUBPOOLS-PAGENO = 0 THEN
               MOVE 'N/S'                       TO PP50-52
           ELSE
               MOVE STG-PROGRAM-SUBPOOLS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Storage Subpools - Task . . . . . . :' TO PP5-41.
           IF STG-TASK-SUBPOOLS-PAGENO = 0 THEN
               MOVE 'N/S'                    TO PP50-52
           ELSE
               MOVE STG-TASK-SUBPOOLS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Subspace Statistics . . . . . . . . :' TO PP5-41.
           IF SUBSPACE-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE SUBSPACE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'System Status' TO PP3-15.
           MOVE 'Page'          TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-15 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'System Status . . . . . . . . . . . :' TO PP5-41.
           IF SYSTEM-STATUS-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE SYSTEM-STATUS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Trace Settings. . . . . . . . . . . :' TO PP5-41.
           IF TRACE-SETTINGS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE TRACE-SETTINGS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '-' TO PRINT-CONTROL.
           MOVE '''N/S'' indicates that the statistics report was not se
      -        'lected for printing          ' TO PP3-84.
           PERFORM WRITE-OUTPUT.

      *****************************************************************
      ***  Print the Page Index headings - Page 3                   ***
      *****************************************************************
           PERFORM PAGE-HEADINGS.

           MOVE '-'     TO PRINT-CONTROL.
           MOVE 'Page Index' TO PP1-10.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP1-10.
           PERFORM WRITE-OUTPUT.

      *****************************************************************
      ***  Print the Page Index - Page 3                            ***
      *****************************************************************
      *****************************************************************
           MOVE '0' TO PRINT-CONTROL.
           MOVE 'TCP/IP' TO PP3-8.
           MOVE 'Page'   TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-8 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'IPCONNs . . . . . . . . . . . . . . :' TO PP5-41.
           IF IPCONNS-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE IPCONNS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'TCP/IP. . . . . . . . . . . . . . . :' TO PP5-41.
           IF TCPIP-PAGENO = 0 THEN
               MOVE 'N/S'        TO PP50-52
           ELSE
               MOVE TCPIP-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'TCP/IP Services . . . . . . . . . . :' TO PP5-41.
           IF TCPIPSERVICES-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE TCPIPSERVICES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Temporary Storage' TO PP3-19.
           MOVE 'Page'              TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-19 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Temporary Storage . . . . . . . . . :' TO PP5-41.
           IF TSQUEUE-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE TSQUEUE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Temporary Storage Models. . . . . . :' TO PP5-41.
           IF TSMODELS-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE TSMODELS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Temporary Storage Queues. . . . . . :' TO PP5-41.
           IF TSQUEUES-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE TSQUEUES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Temporary Storage Queue Totals. . . :' TO PP5-41.
           IF TSQUEUE-TOTALS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE TSQUEUE-TOTALS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Temporary Storage Queues by Pool. . :' TO PP5-41.
           IF TSQUEUES-BY-POOL-PAGENO = 0 THEN
               MOVE 'N/S'                   TO PP50-52
           ELSE
               MOVE TSQUEUES-BY-POOL-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Terminals' TO PP3-11.
           MOVE 'Page'      TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-11 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Terminal Autoinstall. . . . . . . . :' TO PP5-41.
           IF AUTOINSTALL-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE AUTOINSTALL-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'VTAM. . . . . . . . . . . . . . . . :' TO PP5-41.
           IF VTAM-PAGENO = 0 THEN
               MOVE 'N/S'       TO PP50-52
           ELSE
               MOVE VTAM-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Trace              ' TO PP3-7.
           MOVE 'Page'                TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-7 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Trace Settings. . . . . . . . . . . :' TO PP5-41.
           IF TRACE-SETTINGS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE TRACE-SETTINGS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.
           MOVE 'Component Trace Options . . . . . . :' TO PP5-41.
           IF TRACE-LEVELS-PAGENO = 0 THEN
               MOVE 'N/S'               TO PP50-52
           ELSE
               MOVE TRACE-LEVELS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Transaction Manager' TO PP3-21.
           MOVE 'Page'                TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-21 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Transaction Classes . . . . . . . . :' TO PP5-41.
           IF TRANCLASSES-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE TRANCLASSES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Transaction Manager . . . . . . . . :' TO PP5-41.
           IF TRANSACTION-MGR-PAGENO = 0 THEN
               MOVE 'N/S'                  TO PP50-52
           ELSE
               MOVE TRANSACTION-MGR-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Transaction Totals. . . . . . . . . :' TO PP5-41.
           IF TRANSACTION-TOTALS-PAGENO = 0 THEN
               MOVE 'N/S'                     TO PP50-52
           ELSE
               MOVE TRANSACTION-TOTALS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Transactions. . . . . . . . . . . . :' TO PP5-41.
           IF TRANSACTIONS-PAGENO = 0 THEN
               MOVE 'N/S'               TO PP50-52
           ELSE
               MOVE TRANSACTIONS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Transient Data' TO PP3-16.
           MOVE 'Page'           TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-16 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Transient Data. . . . . . . . . . . :' TO PP5-41.
           IF TDQUEUE-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE TDQUEUE-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Transient Data Queues . . . . . . . :' TO PP5-41.
           IF TDQUEUES-PAGENO = 0 THEN
               MOVE 'N/S'           TO PP50-52
           ELSE
               MOVE TDQUEUES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Transient Data Queue Totals . . . . :' TO PP5-41.
           IF TDQUEUE-TOTALS-PAGENO = 0 THEN
               MOVE 'N/S'                 TO PP50-52
           ELSE
               MOVE TDQUEUE-TOTALS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'Web Support'  TO PP3-13.
           MOVE 'Page'         TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-13 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'ATOMSERVICEs. . . . . . . . . . . . :' TO PP5-41.
           IF ATOMSERVICES-PAGENO = 0 THEN
               MOVE 'N/S'               TO PP50-52
           ELSE
               MOVE ATOMSERVICES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'BUNDLEs . . . . . . . . . . . . . . :' TO PP5-41.
           IF BUNDLES-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE BUNDLES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'DOCTEMPLATEs. . . . . . . . . . . . :' TO PP5-41.
           IF DOCTEMPLATES-PAGENO = 0 THEN
               MOVE 'N/S'               TO PP50-52
           ELSE
               MOVE DOCTEMPLATES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'PIPELINEs . . . . . . . . . . . . . :' TO PP5-41.
           IF PIPELINES-PAGENO = 0 THEN
               MOVE 'N/S'            TO PP50-52
           ELSE
               MOVE PIPELINES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'URIMAPs . . . . . . . . . . . . . . :' TO PP5-41.
           IF URIMAPS-PAGENO = 0 THEN
               MOVE 'N/S'          TO PP50-52
           ELSE
               MOVE URIMAPS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'Virtual Hosts . . . . . . . . . . . :' TO PP5-41.
           IF HOSTS-PAGENO = 0 THEN
               MOVE 'N/S'        TO PP50-52
           ELSE
               MOVE HOSTS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'WEBSERVICEs . . . . . . . . . . . . :' TO PP5-41.
           IF WEBSERVICES-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE WEBSERVICES-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE 'XMLTRANSFORMs . . . . . . . . . . . :' TO PP5-41.
           IF XMLTRANSFORMS-PAGENO = 0 THEN
               MOVE 'N/S'                TO PP50-52
           ELSE
               MOVE XMLTRANSFORMS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'WebSphere MQ' TO PP3-14.
           MOVE 'Page'    TO PP49-52.
           PERFORM WRITE-OUTPUT.
           MOVE '+'     TO PRINT-CONTROL.
           MOVE ALL '_' TO PP3-14 PP49-52.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'WebSphere MQ Connection . . . . . . :' TO PP5-41.
           IF MQCONN-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE MQCONN-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '0' TO PRINT-CONTROL.
           MOVE 'WebSphere MQ Monitors . . . . . . . :' TO PP5-41.
           IF MQMONITORS-PAGENO = 0 THEN
               MOVE 'N/S'              TO PP50-52
           ELSE
               MOVE MQMONITORS-PAGENO TO PP43-52
           END-IF.
           PERFORM WRITE-OUTPUT.

           MOVE '-' TO PRINT-CONTROL.
           MOVE '''N/S'' indicates that the statistics report was not se
      -        'lected for printing          ' TO PP3-84.
           PERFORM WRITE-OUTPUT.

       PRINT-PAGE-INDEX-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      *** PAGENOS-INITIALISE                                        ***
      *****************************************************************
       PAGENOS-INITIALISE SECTION.

      *****************************************************************
      ***   Initialise the report page numbers                      ***
      *****************************************************************
           MOVE 0 TO ATOMSERVICES-PAGENO ASYNCSERVICE-PAGENO
                     AUTOINSTALL-PAGENO
                     BUNDLES-PAGENO
                     CAPTURESPECS-PAGENO
                     CFDT-POOLS-PAGENO
                     CONNECTIONS-PAGENO
                     DATA-TABLES-PAGENO
                     DB2-CONNECTION-PAGENO DB2-ENTRIES-PAGENO
                     DFHRPL-ANALYSIS-PAGENO
                     DISPATCHER-PAGENO DISPATCHER-TCB-MODES-PAGENO
                     DISPATCHER-TCB-POOLS-PAGENO
                     DISPATCHER-MVS-TCB-PAGENO
                     DOCTEMPLATES-PAGENO
                     DSNAMES-PAGENO
                     ENQUEUE-MGR-PAGENO ENQMODELS-PAGENO
                     EPADAPTERS-PAGENO
                     EVENT-PROCESS-PAGENO EVENTBINDINGS-PAGENO
                     EXIT-PGM-PAGENO
                     FILES-PAGENO HOSTS-PAGENO
                     IPCONNS-PAGENO
                     JOURNALS-PAGENO
                     JVMSERVERS-PAGENO
                     JVM-PROGRAMS-PAGENO
                     LIBRARY-PAGENO LIBRARY-DSNAME-PAGENO
                     LOADER-PAGENO
                     LOGSTREAM-GLOBAL-PAGENO LOGSTREAMS-PAGENO
                     LSRPOOLS-PAGENO
                     MQCONN-PAGENO MQMONITORS-PAGENO
                     NODEJSAPP-PAGENO
                     PIPELINES-PAGENO
                     PGM-AUTOINSTALL-PAGENO
                     PROGRAMS-PAGENO PROGRAM-STORAGE-PAGENO
                     PROGRAMDEFS-PAGENO
                     PROGRAM-TOTALS-PAGENO PROGRAMS-BY-DSA-PAGENO
                     RECOVERY-MGR-PAGENO
                     STG-DOMAIN-SUBPOOLS-PAGENO
                     STG-PROGRAM-SUBPOOLS-PAGENO
                     STG-TASK-SUBPOOLS-PAGENO
                     STORAGE-ABOVE-PAGENO STORAGE-BELOW-PAGENO
                     STORAGE-ABOVE-BAR-PAGENO
                     SUBSPACE-PAGENO SYSTEM-STATUS-PAGENO
                     TCPIP-PAGENO TCPIPSERVICES-PAGENO
                     TDQUEUE-PAGENO TDQUEUES-PAGENO
                     TDQUEUE-TOTALS-PAGENO
                     TRACE-SETTINGS-PAGENO TRACE-LEVELS-PAGENO
                     TRANCLASSES-PAGENO
                     TRANSACTION-MGR-PAGENO
                     TRANSACTION-TOTALS-PAGENO
                     TRANSACTIONS-PAGENO
                     TSMODELS-PAGENO
                     TSQUEUE-PAGENO TSQUEUES-PAGENO
                     TSQUEUES-BY-POOL-PAGENO
                     TSQUEUE-TOTALS-PAGENO
                     URIMAPS-PAGENO
                     USER-EXITS-PAGENO VTAM-PAGENO
                     WEBSERVICES-PAGENO
                     XMLTRANSFORMS-PAGENO.

       PAGENOS-INITIALISE-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      *** PAGE-HEADINGS                                             ***
      ***   Increment page                                          ***
      ***   Write new heading line to spool                         ***
      *****************************************************************
       PAGE-HEADINGS SECTION.

           ADD 1       TO PAGENO.
           MOVE PAGENO TO PAGE-NUMBER.
           MOVE 1      TO LINE-COUNT.

           MOVE '1'          TO PRINT-CONTROL.
           MOVE HEADING-LINE TO PP1-132.
           PERFORM WRITE-OUTPUT.
           MOVE '+'          TO PRINT-CONTROL.
           MOVE ALL '_'      TO PP1-132.
           PERFORM WRITE-OUTPUT.

           MOVE 'Y' TO SUB-HEADINGS.

       PAGE-HEADINGS-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      *** WRITE-OUTPUT                                              ***
      ***   Write current print line to report output destination.  ***
      *****************************************************************
       WRITE-OUTPUT SECTION.

           PERFORM WRITE-SPOOL.

       WRITE-OUTPUT-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      *** WRITE-SPOOL                                               ***
      *** Write current print line to spool                         ***
      *** Increment line-count                                      ***
      *** IF CICS exceptional condition is raised THEN              ***
      ***    call error routine                                     ***
      *****************************************************************
       WRITE-SPOOL SECTION.

           EXEC CICS SPOOLWRITE TOKEN(OUTPUT-TOKEN)
               FROM(PRINT-LINE) FLENGTH(LINE-LENGTH)
               LINE
               NOHANDLE
           END-EXEC.

           EVALUATE PRINT-CONTROL
               WHEN ' '
                   ADD 1 TO LINE-COUNT
               WHEN '0'
                   ADD 2 TO LINE-COUNT
               WHEN '-'
                   ADD 3 TO LINE-COUNT
               WHEN '+'
                   ADD 0 TO LINE-COUNT
               WHEN '1'
                   MOVE 1 TO LINE-COUNT
           END-EVALUATE.

      *                                       Check return code
           IF EIBRESP NOT = DFHRESP(NORMAL) THEN
               MOVE 'SPOOLWRITE' TO CICS-COMMAND
               PERFORM ERROR-ROUTINE
           ELSE
               MOVE ' '    TO PRINT-CONTROL
               MOVE SPACES TO PP1-132
           END-IF.

       WRITE-SPOOL-EXIT.
           EXIT.
           EJECT
      *****************************************************************
      ***  ERROR ROUTINE                                            ***
      ***  Error routine produces appropriate responses to CICS     ***
      ***  spool commands. To ensure this the resp and resp2 values ***
      ***  are returned to the main program DFH0STAT for appropriate***
      ***  outputing of the messages.                               ***
      *****************************************************************
       ERROR-ROUTINE SECTION.

      *  If an error occurs which is not due to the users input or if
      *  the program is not being run from a terminal then a general
      *  message is sent to the screen/console and the RESP and RESP2
      *  fields are given along with the spool command which failed.
           MOVE 'Y'      TO ERROR-FOUND.
           MOVE EIBRESP  TO STCM-RESP.
           MOVE EIBRESP2 TO STCM-RESP2.

      *  Whatever happens ensure we return to DFH0STAT quickly.
           EXEC CICS RETURN
           END-EXEC.

       ERROR-ROUTINE-EXIT.
           EXIT.
